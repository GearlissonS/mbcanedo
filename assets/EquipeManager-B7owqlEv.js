import{c as C,h as ne,r as i,j as e,i as b,k as ce,af as de,a as m,u as ue,$ as D,a0 as d}from"./index-B2eCoH1P.js";import{C as pe,a as me,b as ge,c as fe}from"./card-BcAP0yC-.js";import{b as T,B as N}from"./button-DQnByZSr.js";import{I as w}from"./index-BUABG10p.js";import{T as xe,a as he,b as E,c as j,d as ve,e as h}from"./table-Bi-eMIx7.js";import{c as R,b as ye,O as Ne,W as je,C as Ae,T as De,D as Ee,a as q,R as Ce,P as we}from"./index-Dfq1Y8wH.js";import{C as be}from"./check-Df84_UGV.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=C("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=C("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=C("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var S="AlertDialog",[Se,Ze]=ne(S,[R]),u=R(),_=a=>{const{__scopeAlertDialog:r,...s}=a,o=u(r);return e.jsx(Ce,{...o,...s,modal:!0})};_.displayName=S;var _e="AlertDialogTrigger",M=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,n=u(s);return e.jsx(ye,{...n,...o,ref:r})});M.displayName=_e;var Me="AlertDialogPortal",P=a=>{const{__scopeAlertDialog:r,...s}=a,o=u(r);return e.jsx(we,{...o,...s})};P.displayName=Me;var Pe="AlertDialogOverlay",k=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,n=u(s);return e.jsx(Ne,{...n,...o,ref:r})});k.displayName=Pe;var v="AlertDialogContent",[ke,ze]=Se(v),Oe=de("AlertDialogContent"),z=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,children:o,...n}=a,g=u(s),c=i.useRef(null),y=b(r,c),x=i.useRef(null);return e.jsx(je,{contentName:v,titleName:O,docsSlug:"alert-dialog",children:e.jsx(ke,{scope:s,cancelRef:x,children:e.jsxs(Ae,{role:"alertdialog",...g,...n,ref:y,onOpenAutoFocus:ce(n.onOpenAutoFocus,p=>{var f;p.preventDefault(),(f=x.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[e.jsx(Oe,{children:o}),e.jsx($e,{contentRef:c})]})})})});z.displayName=v;var O="AlertDialogTitle",I=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,n=u(s);return e.jsx(De,{...n,...o,ref:r})});I.displayName=O;var $="AlertDialogDescription",F=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,n=u(s);return e.jsx(Ee,{...n,...o,ref:r})});F.displayName=$;var Ie="AlertDialogAction",L=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,n=u(s);return e.jsx(q,{...n,...o,ref:r})});L.displayName=Ie;var H="AlertDialogCancel",B=i.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...o}=a,{cancelRef:n}=ze(H,s),g=u(s),c=b(r,n);return e.jsx(q,{...g,...o,ref:c})});B.displayName=H;var $e=({contentRef:a})=>{const r=`\`${v}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${v}\` by passing a \`${$}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${v}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return i.useEffect(()=>{var o;document.getElementById((o=a.current)==null?void 0:o.getAttribute("aria-describedby"))||console.warn(r)},[r,a]),null},Fe=_,Le=M,He=P,V=k,G=z,W=L,Y=B,J=I,K=F;const Be=Fe,Ve=Le,Ge=He,Q=i.forwardRef(({className:a,...r},s)=>e.jsx(V,{className:m("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:s}));Q.displayName=V.displayName;const U=i.forwardRef(({className:a,...r},s)=>e.jsxs(Ge,{children:[e.jsx(Q,{}),e.jsx(G,{ref:s,className:m("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]}));U.displayName=G.displayName;const X=({className:a,...r})=>e.jsx("div",{className:m("flex flex-col space-y-2 text-center sm:text-left",a),...r});X.displayName="AlertDialogHeader";const Z=({className:a,...r})=>e.jsx("div",{className:m("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...r});Z.displayName="AlertDialogFooter";const ee=i.forwardRef(({className:a,...r},s)=>e.jsx(J,{ref:s,className:m("text-lg font-semibold",a),...r}));ee.displayName=J.displayName;const ae=i.forwardRef(({className:a,...r},s)=>e.jsx(K,{ref:s,className:m("text-sm text-muted-foreground",a),...r}));ae.displayName=K.displayName;const re=i.forwardRef(({className:a,...r},s)=>e.jsx(W,{ref:s,className:m(T(),a),...r}));re.displayName=W.displayName;const se=i.forwardRef(({className:a,...r},s)=>e.jsx(Y,{ref:s,className:m(T({variant:"outline"}),"mt-2 sm:mt-0",a),...r}));se.displayName=Y.displayName;function ea(){const{settings:a}=ue(),[r,s]=i.useState([]),[o,n]=i.useState(""),[g,c]=i.useState(!1),[y,x]=i.useState(null),[p,f]=i.useState("");i.useEffect(()=>{A()},[]);async function A(){c(!0);try{const{data:t,error:l}=await D.from("equipes").select("*").order("nome");l?(console.error("[EquipeManager] carregarEquipes failed",l),d.error("Erro ao carregar equipes")):s(t||[])}catch(t){console.error("[EquipeManager] carregarEquipes threw",t),d.error("Erro ao carregar equipes")}finally{c(!1)}}async function te(){const t=o.trim();if(!t)return d.warning("Informe o nome da equipe");c(!0);try{const{error:l}=await D.from("equipes").insert([{nome:t}]);if(l)return console.error("[EquipeManager] inserir equipe failed",l),d.error("Não foi possível salvar");d.success("Equipe adicionada"),n(""),A()}catch(l){console.error("[EquipeManager] inserir equipe threw",l),d.error("Não foi possível salvar")}finally{c(!1)}}function oe(t){x(t.id),f(t.nome)}async function ie(){const t=(p||"").trim();if(!t)return d.warning("Nome inválido");c(!0);try{const{error:l}=await D.from("equipes").update({nome:t}).eq("id",y);if(l)return console.error("[EquipeManager] atualizar equipe failed",l),d.error("Falha ao atualizar");d.success("Equipe atualizada"),x(null),f(""),A()}catch(l){console.error("[EquipeManager] atualizar equipe threw",l),d.error("Falha ao atualizar")}finally{c(!1)}}async function le(t){c(!0);try{const{error:l}=await D.from("equipes").delete().eq("id",t);if(l)return console.error("[EquipeManager] excluir equipe failed",l),d.error("Falha ao excluir");d.success("Equipe excluída"),A()}catch(l){console.error("[EquipeManager] excluir equipe threw",l),d.error("Falha ao excluir")}finally{c(!1)}}return e.jsx("div",{className:"p-2",children:e.jsxs(pe,{className:"w-full",children:[e.jsxs(me,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(ge,{children:"Equipes"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(w,{placeholder:"Nova equipe…",value:o,onChange:t=>n(t.target.value),disabled:g,className:"w-56"}),e.jsxs(N,{onClick:te,disabled:g,className:"gap-2",children:[e.jsx(Te,{size:18})," Adicionar"]})]})]}),e.jsx(fe,{children:g&&r.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Carregando…"}):e.jsxs(xe,{children:[e.jsx(he,{children:e.jsxs(E,{children:[e.jsx(j,{className:"w-[80px]",children:"ID"}),e.jsx(j,{children:"Nome"}),e.jsx(j,{className:"w-[160px]",children:"Criada em"}),e.jsx(j,{className:"w-[140px]",children:"Corretores"}),e.jsx(j,{className:"w-[220px] text-right",children:"Ações"})]})}),e.jsx(ve,{children:r.length===0?e.jsx(E,{children:e.jsx(h,{colSpan:5,className:"text-muted-foreground",children:"Nenhuma equipe cadastrada."})}):r.map(t=>e.jsxs(E,{children:[e.jsx(h,{className:"text-muted-foreground",children:t.id}),e.jsx(h,{children:y===t.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{value:p,onChange:l=>f(l.target.value),className:"max-w-sm",autoFocus:!0}),e.jsxs(N,{size:"sm",className:"gap-1",onClick:ie,children:[e.jsx(be,{size:16})," Salvar"]}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{x(null),f("")},children:"Cancelar"})]}):e.jsx("span",{className:"font-medium",children:t.nome})}),e.jsx(h,{children:t.created_at?new Date(t.created_at).toLocaleDateString():"—"}),e.jsx(h,{children:Array.isArray(a==null?void 0:a.brokers)?(a.brokers||[]).filter(l=>l.team===t.nome).length:0}),e.jsx(h,{className:"text-right",children:y!==t.id?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(N,{size:"sm",variant:"secondary",className:"gap-1",onClick:()=>oe(t),children:[e.jsx(Re,{size:16})," Editar"]}),e.jsxs(Be,{children:[e.jsx(Ve,{asChild:!0,children:e.jsxs(N,{size:"sm",variant:"destructive",className:"gap-1",children:[e.jsx(qe,{size:16})," Excluir"]})}),e.jsxs(U,{children:[e.jsxs(X,{children:[e.jsx(ee,{children:"Excluir equipe"}),e.jsxs(ae,{children:['Tem certeza que deseja excluir "',t.nome,'"? Essa ação não pode ser desfeita.']})]}),e.jsxs(Z,{children:[e.jsx(se,{children:"Cancelar"}),e.jsx(re,{onClick:()=>le(t.id),children:"Excluir"})]})]})]})]}):null})]},t.id))})]})})]})})}export{ea as default};

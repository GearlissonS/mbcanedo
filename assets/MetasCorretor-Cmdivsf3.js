import{j as e,a as $,ac as V,r as m,B as F}from"./index-CTZz0_N_.js";import{C as J}from"./card-BRs48jVZ.js";import{I as k}from"./index-DcMvDx-7.js";import{T as L,a as H,b as I,c as D}from"./tabs-C6p-ivEB.js";import{S as O,a as q,b as K,c as G,d as Q}from"./select-Cd8ymJS9.js";import{T as U,a as W,b as S,c as x,d as X,e as h}from"./table-BcQheilz.js";import"./index-FwwCZN4R.js";import"./check-1Un8lB0-.js";function Y({className:l,variant:s,...i}){return e.jsx("div",{className:$(V({variant:s}),l),...i})}const y=[{key:0,label:"Jan"},{key:1,label:"Fev"},{key:2,label:"Mar"},{key:3,label:"Abr"},{key:4,label:"Mai"},{key:5,label:"Jun"},{key:6,label:"Jul"},{key:7,label:"Ago"},{key:8,label:"Set"},{key:9,label:"Out"},{key:10,label:"Nov"},{key:11,label:"Dez"}],Z=[{id:"1",nome:"Jo√£o Silva"},{id:"2",nome:"Maria Souza"},{id:"3",nome:"Carlos Lima"},{id:"4",nome:"Ana Paula"},{id:"5",nome:"Bruno Castro"},{id:"6",nome:"Fernanda Alves"},{id:"7",nome:"Rafael Gomes"},{id:"8",nome:"Juliana Rocha"}];function f(l){return`R$ ${Math.round(l||0).toLocaleString("pt-BR")}`}function _(l,s){return!s||s<=0?0:Math.max(0,Math.min(100,l/s*100))}function ee(l,s,i){return l>=i?"bg-green-500":l>=s?"bg-yellow-500":"bg-red-500"}function ae({value:l,colorClass:s}){return e.jsx("div",{className:"h-2 w-full rounded bg-muted",children:e.jsx("div",{className:`h-2 rounded ${s}`,style:{width:`${Math.max(0,Math.min(100,l))}%`}})})}const se=()=>y.reduce((l,s)=>(l[s.key]=Z.map((i,o)=>({id:i.id,nome:i.nome,metaPiso:2e5+o*25e3,metaAlvo:35e4+o*3e4,realizado:(o%3===0?38e4:15e4)+(s.key%2===0?o*8e3:o*5e3)})),l),{});function me(){const l=new Date,[s,i]=m.useState(l.getMonth()),[o,M]=m.useState(se()),[g,C]=m.useState(""),[j,T]=m.useState(!0),[v,w]=m.useState(null),u=o[s]||[],A=m.useMemo(()=>{const a=g.trim().toLowerCase();let t=u.filter(n=>a?n.nome.toLowerCase().includes(a):!0);return j&&(t=[...t].sort((n,r)=>r.realizado-n.realizado)),t},[u,g,j]),R=m.useMemo(()=>{if(!u.length)return 0;const a=u.filter(t=>t.realizado>=t.metaAlvo).length;return Math.round(a/u.length*100)},[u]),z=(a,t,n)=>{M(r=>({...r,[s]:r[s].map(d=>d.id===a?{...d,[t]:Number.isFinite(n)?Math.max(0,n):0}:d)}))},B=(a,t)=>w({id:a,field:t}),N=()=>w(null),p=({broker:a,field:t,format:n,className:r})=>{const d=v&&v.id===a.id&&v.field===t,c=a[t],E=typeof c=="number"&&n?n(c):String(c);if(t==="nome")return e.jsx("span",{className:r,children:String(c)});const P=typeof c=="number"?c:Number(c)||0;return e.jsx("div",{className:r,children:d?e.jsx(k,{autoFocus:!0,type:"number",value:P,onChange:b=>z(a.id,t,Number(b.target.value)),onBlur:N,onKeyDown:b=>{b.key==="Enter"&&N()},className:"h-8 w-28"}):e.jsx("button",{onClick:()=>B(a.id,t),className:"hover:underline focus:underline",children:E})})};return e.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Metas por Corretor"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{className:"bg-green-600 text-white",children:["% equipe bateu meta: ",R,"%"]}),e.jsx(F,{variant:j?"default":"secondary",onClick:()=>T(a=>!a),children:j?"Ranking ativo":"Ranking inativo"})]})]}),e.jsx(J,{className:"p-3 md:p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(L,{value:String(s),onValueChange:a=>i(Number(a)),children:[e.jsx(H,{className:"grid grid-cols-6 lg:grid-cols-12",children:y.map(a=>e.jsx(I,{value:String(a.key),children:a.label},a.key))}),e.jsx(D,{value:String(s)})]})}),e.jsx("div",{className:"md:hidden w-full max-w-xs",children:e.jsxs(O,{value:String(s),onValueChange:a=>i(Number(a)),children:[e.jsx(q,{children:e.jsx(K,{placeholder:"M√™s"})}),e.jsx(G,{children:y.map(a=>e.jsx(Q,{value:String(a.key),children:a.label},a.key))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-full md:w-auto",children:e.jsx(k,{value:g,onChange:a=>C(a.target.value),placeholder:"Buscar corretor...",className:"max-w-xs"})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(U,{children:[e.jsx(W,{children:e.jsxs(S,{children:[e.jsx(x,{children:"Corretor"}),e.jsx(x,{children:"Meta Piso"}),e.jsx(x,{children:"Meta Alvo"}),e.jsx(x,{children:"Realizado"}),e.jsx(x,{className:"min-w-[280px]",children:"Progresso"})]})}),e.jsx(X,{children:A.map(a=>{const t=_(a.realizado,a.metaAlvo),n=ee(a.realizado,a.metaPiso,a.metaAlvo),r=Math.max(0,a.metaAlvo-a.realizado),d=a.realizado>a.metaAlvo;return e.jsxs(S,{className:"align-middle",children:[e.jsxs(h,{className:"font-medium whitespace-nowrap",children:[d?e.jsx("span",{className:"mr-1",children:"üî•"}):null,e.jsx(p,{broker:a,field:"nome"})]}),e.jsx(h,{className:"whitespace-nowrap",children:e.jsx(p,{broker:a,field:"metaPiso",format:f})}),e.jsx(h,{className:"whitespace-nowrap",children:e.jsx(p,{broker:a,field:"metaAlvo",format:f})}),e.jsx(h,{className:"whitespace-nowrap",children:e.jsx(p,{broker:a,field:"realizado",format:f})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-56",children:e.jsx(ae,{value:t,colorClass:n})}),e.jsxs("div",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[t.toFixed(0),"% ",r>0?`‚Ä¢ falta ${f(r)}`:"‚Ä¢ meta batida"]})]})})]},`${a.id}-${s}`)})})]})})]})}export{me as default};

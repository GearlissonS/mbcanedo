import{c as E,r as i,a0 as w,t as z,u as A,j as e,H as I,m as v,d as j,a5 as N,a6 as k,a7 as S}from"./index-mXs6O_L0.js";import{I as M}from"./index-DU86pWCi.js";import{L as R}from"./index-75ZM4oPI.js";import{S as G,a as H,b as T,c as P,d as C}from"./select-D8AdoDiN.js";import"./check-AxkTEtua.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=E("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);function Y(d){i.useEffect(()=>{const g=w.channel("realtime-sales").on("postgres_changes",{event:"*",schema:"public",table:"sales"},r=>{r.eventType==="INSERT"&&r.new&&d(r.new)}).subscribe();return()=>{w.removeChannel(g)}},[d])}function Q(){const{sales:d,setSales:g}=z();Y(a=>{g([...d,a])});const{settings:r,playRankingSound:h}=A(),[u,L]=i.useState("mensal"),[p,$]=i.useState(""),[y,f]=i.useState(null),m=i.useMemo(()=>{const a=new Date;let t,n;u==="mensal"?(t=new Date(a.getFullYear(),a.getMonth(),1),n=new Date(a.getFullYear(),a.getMonth()+1,0)):(t=new Date(a.getFullYear(),0,1),n=new Date(a.getFullYear(),11,31));const o=new Map;d.forEach(s=>{const c=new Date(s.dataCompetencia);c>=t&&c<=n&&o.set(s.vendedor,(o.get(s.vendedor)||0)+s.vgv)});const l=Array.from(o.entries()).map(([s,c])=>({vendedor:s,vgv:c}));return l.sort((s,c)=>c.vgv-s.vgv),p.trim()?l.filter(s=>s.vendedor.toLowerCase().includes(p.trim().toLowerCase())):l},[d,u,p]),x=i.useRef([]);i.useEffect(()=>{x.current.length&&m.forEach((a,t)=>{const n=x.current.indexOf(a.vendedor);n!==-1&&n>t&&(r.rankingSoundEnabled&&(r.rankingSoundFile?new Audio(r.rankingSoundFile).play():h()),f(a.vendedor),setTimeout(()=>f(null),2e3))}),x.current=m.map(a=>a.vendedor)},[m,h,r.rankingSoundFile,r.rankingSoundEnabled]);const D=[{vendedor:"Ana Souza",vgv:125e4,avatar:"https://i.pravatar.cc/128?u=ana.souza"},{vendedor:"Bruno Lima",vgv:98e4,avatar:"https://i.pravatar.cc/128?u=bruno.lima"},{vendedor:"Carla Mendes",vgv:87e4,avatar:"https://i.pravatar.cc/128?u=carla.mendes"},{vendedor:"Diego Rocha",vgv:65e4,avatar:"https://i.pravatar.cc/128?u=diego.rocha"},{vendedor:"Eduarda Pires",vgv:54e4,avatar:"https://i.pravatar.cc/128?u=eduarda.pires"},{vendedor:"Felipe Nunes",vgv:43e4,avatar:"https://i.pravatar.cc/128?u=felipe.nunes"}],F=a=>a.map(t=>{var l;const n=(l=r.brokers)==null?void 0:l.find(s=>s.name===t.vendedor),o=(n==null?void 0:n.avatarDataUrl)||`https://i.pravatar.cc/128?u=${encodeURIComponent(t.vendedor||"anon")}`;return{...t,avatar:o}}),b=m.length?F(m):D,V=b.slice(0,3),B=b.slice(3);return e.jsxs("main",{className:"space-y-6","aria-label":"Ranking de Corretores",children:[e.jsxs(I,{children:[e.jsxs("title",{children:[r.title," — Ranking"]}),e.jsx("meta",{name:"description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{property:"og:title",content:`${r.title} — Ranking`}),e.jsx("meta",{property:"og:description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:window.location.href}),e.jsx("meta",{property:"og:image",content:r.logoDataUrl||""}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:`${r.title} — Ranking`}),e.jsx("meta",{name:"twitter:description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{name:"twitter:image",content:r.logoDataUrl||""})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-end gap-3",children:[e.jsxs("button",{type:"button",className:"ml-auto flex items-center gap-2 px-3 py-2 rounded bg-primary text-white hover:bg-primary-glow transition","aria-label":"Abrir ranking em tela cheia",onClick:()=>window.open("/ranking/full","_blank"),children:[e.jsx(U,{className:"w-5 h-5"}),"Tela Cheia"]}),e.jsx(R,{htmlFor:"periodo",children:"Período"}),e.jsxs(G,{value:u,onValueChange:a=>L(a),children:[e.jsx(H,{className:"w-40",id:"periodo","aria-label":"Selecionar período",children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(C,{value:"mensal",children:"Mensal"}),e.jsx(C,{value:"anual",children:"Anual"})]})]}),e.jsx(R,{htmlFor:"busca",className:"ml-4",children:"Buscar corretor"}),e.jsx(M,{id:"busca",type:"text",placeholder:"Digite o nome...",value:p,onChange:a=>$(a.target.value),className:"w-48","aria-label":"Buscar corretor"})]}),e.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 p-8 rounded-xl border bg-card shadow-[var(--shadow-elevated)] overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-primary-glow/10 pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center bg-gradient-to-r from-primary to-primary-glow bg-clip-text text-transparent",children:"🏆 Pódio dos Campeões"}),e.jsx("div",{className:"flex items-end justify-center gap-8 min-h-[320px]",children:[1,0,2].map(a=>{const t=V[a];if(!t)return null;const n={0:"h-32",1:"h-24",2:"h-20"},o={0:"from-yellow-300 via-yellow-500 to-yellow-600",1:"from-gray-300 via-gray-400 to-gray-500",2:"from-amber-600 via-amber-700 to-amber-800"},l={0:"shadow-yellow-500/30",1:"shadow-gray-400/30",2:"shadow-amber-600/30"};return e.jsxs(v.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.7,delay:a*.2},whileHover:{scale:1.07,boxShadow:"0 8px 32px #FFD70055"},className:`text-center ${r.rankingAnimation?"transition-all duration-300":""} ${y===t.vendedor?"ring-4 ring-primary-glow":""}`,style:{animationDelay:`${a*.2}s`},"aria-label":`Corretor ${t.vendedor}, posição ${a+1}`,children:[e.jsx(v.div,{className:`inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br ${o[a]} shadow-lg ${l[a]} mb-4 animate-pulse`,whileHover:{scale:1.12},children:e.jsx("span",{className:"text-2xl font-bold text-white drop-shadow-lg",children:a===0?"1°":a===1?"2°":"3°"})}),e.jsxs("div",{className:`mx-auto ${n[a]} w-20 bg-gradient-to-t from-primary/20 to-primary/10 rounded-t-lg border-2 border-primary/30 relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/10 to-transparent"}),e.jsxs("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 text-xs font-bold text-primary",children:[a+1,"º"]})]}),e.jsx("div",{className:"mx-auto -mt-8 relative z-10",children:e.jsx("div",{className:"w-16 h-16 rounded-full p-1 bg-gradient-to-br from-primary via-primary-glow to-primary shadow-lg",children:e.jsxs(j,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-muted rounded absolute -top-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:["VGV: ",t.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),e.jsxs(N,{className:"h-full w-full ring-2 ring-white",children:[e.jsx(k,{src:t.avatar,alt:`Foto de ${t.vendedor}`,loading:"lazy"}),e.jsx(S,{className:"bg-gradient-to-br from-primary/20 to-primary-glow/20 text-primary font-bold",children:(t.vendedor||"—").split(" ").map(s=>s[0]).join("").slice(0,2)})]})]})})}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t.vendedor||"—"}),e.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:t.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),a===0&&e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-yellow-400/20 to-yellow-600/20 rounded-full text-xs font-bold text-yellow-700 border border-yellow-400/30",children:"👑 Líder"})]})]},t.vendedor)})})]})]}),e.jsxs("div",{className:"p-6 rounded-xl border bg-card shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Demais corretores"}),e.jsx("ol",{className:"space-y-2","aria-label":"Lista de corretores",children:B.map((a,t)=>e.jsxs(v.li,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2+t*.08},whileHover:{scale:1.03,backgroundColor:"#1e293b"},className:`flex items-center justify-between p-2 rounded-md bg-muted/40 ${y===a.vendedor?"ring-2 ring-primary-glow":""}`,"aria-label":`Corretor ${a.vendedor}, posição ${t+4}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"w-6 text-sm font-semibold",children:["#",t+4]}),e.jsxs(j,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-muted rounded absolute -top-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:["VGV: ",a.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),e.jsxs(N,{className:"h-8 w-8",children:[e.jsx(k,{src:a.avatar,alt:`Foto de ${a.vendedor}`,loading:"lazy"}),e.jsx(S,{children:(a.vendedor||"—").split(" ").map(n=>n[0]).join("").slice(0,2)})]})]}),e.jsx("span",{className:"font-medium",children:a.vendedor||"—"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]},a.vendedor))})]})]})]})}export{Q as default};

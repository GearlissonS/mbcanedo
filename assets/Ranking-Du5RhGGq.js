import{c as E,r as i,a0 as w,p as A,u as M,j as e,H as z,m as x,d as j,a1 as N,a2 as k,a3 as S}from"./index-CwKbJFaL.js";import{I}from"./index-D4lnNBb7.js";import{L as R}from"./label-0etJ742I.js";import{S as H,a as G,b as T,c as _,d as C}from"./select-DmYgAqCo.js";import"./index-xG6qX_Hd.js";import"./check-BYBW0e-1.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],U=E("maximize-2",P);function Y(d){i.useEffect(()=>{const g=w.channel("realtime-sales").on("postgres_changes",{event:"*",schema:"public",table:"sales"},r=>{r.eventType==="INSERT"&&r.new&&d(r.new)}).subscribe();return()=>{w.removeChannel(g)}},[d])}function X(){const{sales:d,setSales:g}=A();Y(a=>{g([...d,a])});const{settings:r,playRankingSound:h}=M(),[u,L]=i.useState("mensal"),[p,$]=i.useState(""),[y,b]=i.useState(null),m=i.useMemo(()=>{const a=new Date;let t,s;u==="mensal"?(t=new Date(a.getFullYear(),a.getMonth(),1),s=new Date(a.getFullYear(),a.getMonth()+1,0)):(t=new Date(a.getFullYear(),0,1),s=new Date(a.getFullYear(),11,31));const o=new Map;d.forEach(n=>{const c=new Date(n.dataCompetencia);c>=t&&c<=s&&o.set(n.vendedor,(o.get(n.vendedor)||0)+n.vgv)});const l=Array.from(o.entries()).map(([n,c])=>({vendedor:n,vgv:c}));return l.sort((n,c)=>c.vgv-n.vgv),p.trim()?l.filter(n=>n.vendedor.toLowerCase().includes(p.trim().toLowerCase())):l},[d,u,p]),v=i.useRef([]);i.useEffect(()=>{v.current.length&&m.forEach((a,t)=>{const s=v.current.indexOf(a.vendedor);s!==-1&&s>t&&(r.rankingSoundEnabled&&(r.rankingSoundFile?new Audio(r.rankingSoundFile).play():h()),b(a.vendedor),setTimeout(()=>b(null),2e3))}),v.current=m.map(a=>a.vendedor)},[m,h,r.rankingSoundFile,r.rankingSoundEnabled]);const D=[{vendedor:"Ana Souza",vgv:125e4,avatar:"https://i.pravatar.cc/128?u=ana.souza"},{vendedor:"Bruno Lima",vgv:98e4,avatar:"https://i.pravatar.cc/128?u=bruno.lima"},{vendedor:"Carla Mendes",vgv:87e4,avatar:"https://i.pravatar.cc/128?u=carla.mendes"},{vendedor:"Diego Rocha",vgv:65e4,avatar:"https://i.pravatar.cc/128?u=diego.rocha"},{vendedor:"Eduarda Pires",vgv:54e4,avatar:"https://i.pravatar.cc/128?u=eduarda.pires"},{vendedor:"Felipe Nunes",vgv:43e4,avatar:"https://i.pravatar.cc/128?u=felipe.nunes"}],F=a=>a.map(t=>{const o=r.brokers?.find(l=>l.name===t.vendedor)?.avatarDataUrl||`https://i.pravatar.cc/128?u=${encodeURIComponent(t.vendedor||"anon")}`;return{...t,avatar:o}}),f=m.length?F(m):D,V=f.slice(0,3),B=f.slice(3);return e.jsxs("main",{className:"space-y-6","aria-label":"Ranking de Corretores",children:[e.jsxs(z,{children:[e.jsxs("title",{children:[r.title," — Ranking"]}),e.jsx("meta",{name:"description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{property:"og:title",content:`${r.title} — Ranking`}),e.jsx("meta",{property:"og:description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:window.location.href}),e.jsx("meta",{property:"og:image",content:r.logoDataUrl||""}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:`${r.title} — Ranking`}),e.jsx("meta",{name:"twitter:description",content:"Ranking gamificado de corretores, com pódio e lista ordenada por VGV."}),e.jsx("meta",{name:"twitter:image",content:r.logoDataUrl||""})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-end gap-3",children:[e.jsxs("button",{type:"button",className:"ml-auto flex items-center gap-2 px-3 py-2 rounded bg-primary text-white hover:bg-primary-glow transition","aria-label":"Abrir ranking em tela cheia",onClick:()=>window.open("/ranking/full","_blank"),children:[e.jsx(U,{className:"w-5 h-5"}),"Tela Cheia"]}),e.jsx(R,{htmlFor:"periodo",children:"Período"}),e.jsxs(H,{value:u,onValueChange:a=>L(a),children:[e.jsx(G,{className:"w-40",id:"periodo","aria-label":"Selecionar período",children:e.jsx(T,{})}),e.jsxs(_,{children:[e.jsx(C,{value:"mensal",children:"Mensal"}),e.jsx(C,{value:"anual",children:"Anual"})]})]}),e.jsx(R,{htmlFor:"busca",className:"ml-4",children:"Buscar corretor"}),e.jsx(I,{id:"busca",type:"text",placeholder:"Digite o nome...",value:p,onChange:a=>$(a.target.value),className:"w-48","aria-label":"Buscar corretor"})]}),e.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 p-8 rounded-xl border bg-card shadow-[var(--shadow-elevated)] overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-primary-glow/10 pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center bg-gradient-to-r from-primary to-primary-glow bg-clip-text text-transparent",children:"🏆 Pódio dos Campeões"}),e.jsx("div",{className:"flex items-end justify-center gap-8 min-h-[320px]",children:[1,0,2].map(a=>{const t=V[a];if(!t)return null;const s={0:"h-32",1:"h-24",2:"h-20"},o={0:"from-yellow-300 via-yellow-500 to-yellow-600",1:"from-gray-300 via-gray-400 to-gray-500",2:"from-amber-600 via-amber-700 to-amber-800"},l={0:"shadow-yellow-500/30",1:"shadow-gray-400/30",2:"shadow-amber-600/30"};return e.jsxs(x.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.7,delay:a*.2},whileHover:{scale:1.07,boxShadow:"0 8px 32px #FFD70055"},className:`text-center ${r.rankingAnimation?"transition-all duration-300":""} ${y===t.vendedor?"ring-4 ring-primary-glow":""}`,style:{animationDelay:`${a*.2}s`},"aria-label":`Corretor ${t.vendedor}, posição ${a+1}`,children:[e.jsx(x.div,{className:`inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br ${o[a]} shadow-lg ${l[a]} mb-4 animate-pulse`,whileHover:{scale:1.12},children:e.jsx("span",{className:"text-2xl font-bold text-white drop-shadow-lg",children:a===0?"1°":a===1?"2°":"3°"})}),e.jsxs("div",{className:`mx-auto ${s[a]} w-20 bg-gradient-to-t from-primary/20 to-primary/10 rounded-t-lg border-2 border-primary/30 relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/10 to-transparent"}),e.jsxs("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 text-xs font-bold text-primary",children:[a+1,"º"]})]}),e.jsx("div",{className:"mx-auto -mt-8 relative z-10",children:e.jsx("div",{className:"w-16 h-16 rounded-full p-1 bg-gradient-to-br from-primary via-primary-glow to-primary shadow-lg",children:e.jsxs(j,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-muted rounded absolute -top-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:["VGV: ",t.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),e.jsxs(N,{className:"h-full w-full ring-2 ring-white",children:[e.jsx(k,{src:t.avatar,alt:`Foto de ${t.vendedor}`,loading:"lazy"}),e.jsx(S,{className:"bg-gradient-to-br from-primary/20 to-primary-glow/20 text-primary font-bold",children:(t.vendedor||"—").split(" ").map(n=>n[0]).join("").slice(0,2)})]})]})})}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t.vendedor||"—"}),e.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:t.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),a===0&&e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-yellow-400/20 to-yellow-600/20 rounded-full text-xs font-bold text-yellow-700 border border-yellow-400/30",children:"👑 Líder"})]})]},t.vendedor)})})]})]}),e.jsxs("div",{className:"p-6 rounded-xl border bg-card shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Demais corretores"}),e.jsx("ol",{className:"space-y-2","aria-label":"Lista de corretores",children:B.map((a,t)=>e.jsxs(x.li,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2+t*.08},whileHover:{scale:1.03,backgroundColor:"#1e293b"},className:`flex items-center justify-between p-2 rounded-md bg-muted/40 ${y===a.vendedor?"ring-2 ring-primary-glow":""}`,"aria-label":`Corretor ${a.vendedor}, posição ${t+4}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"w-6 text-sm font-semibold",children:["#",t+4]}),e.jsxs(j,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-muted rounded absolute -top-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:["VGV: ",a.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),e.jsxs(N,{className:"h-8 w-8",children:[e.jsx(k,{src:a.avatar,alt:`Foto de ${a.vendedor}`,loading:"lazy"}),e.jsx(S,{children:(a.vendedor||"—").split(" ").map(s=>s[0]).join("").slice(0,2)})]})]}),e.jsx("span",{className:"font-medium",children:a.vendedor||"—"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.vgv.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]},a.vendedor))})]})]})]})}export{X as default};
